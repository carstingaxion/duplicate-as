(()=>{"use strict";var t={n:e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return t.d(o,{a:o}),o},d:(e,o)=>{for(var s in o)t.o(o,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:o[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};const e=window.wp.plugins,o=window.wp.editor,s=window.wp.element,r=window.wp.i18n,p=window.wp.apiFetch;var n=t.n(p);const a=window.wp.data,i=window.wp.coreData,c=window.wp.components,u=window.ReactJSXRuntime;function l({postId:t,targetPostType:e,currentPostType:o,targetPostTypeObject:p}){const[a,i]=(0,s.useState)(!1),l=e&&e!==o,d=l?(0,r.sprintf)(/* translators: %s: target post type singular name */ /* translators: %s: target post type singular name */
(0,r.__)("Transform to %s","post-morph"),p?.labels?.singular_name||e):(0,r.__)("Duplicate","post-morph"),y=l?function(t){return t&&"string"==typeof t?t.startsWith("data:")?"admin-page":t.startsWith("dashicons-")?t.replace("dashicons-",""):t:"admin-page"}(p?.icon):"admin-page";return(0,u.jsx)(c.Button,{variant:"secondary",isPressed:!1,isBusy:a,onClick:async()=>{if(t&&!a){i(!0);try{const o=e?{target_post_type:e}:{},s=await n()({path:`/post-morph/v1/duplicate/${t}`,method:"POST",data:o});s.success&&s.edit_url&&(window.location.href=s.edit_url)}catch(t){console.error("Duplication failed:",t);const e=l?(0,r.__)("Failed to transform post. Please try again.","post-morph"):(0,r.__)("Failed to duplicate post. Please try again.","post-morph");alert(e),i(!1)}}},disabled:a,icon:y,className:"post-morph-button",children:a?(0,r.__)("Processing...","post-morph"):d})}(0,e.registerPlugin)("post-morph",{render:function(){const{postId:t,postType:e,postTypeObject:s,allPostTypes:r}=(0,a.useSelect)(t=>{const e=t(o.store).getCurrentPostType(),s=t(i.store).getPostType(e),r=t(i.store).getPostTypes({per_page:-1})||[];return{postId:t(o.store).getCurrentPostId(),postType:e,postTypeObject:s,allPostTypes:r}},[]);if(!t||!s?.supports?.duplicate_post)return null;const p=function(t){if(!t?.supports?.duplicate_post)return[];const e=t.supports.duplicate_post;return Array.isArray(e)?e[0].filter(t=>"string"==typeof t&&t.length>0):"string"==typeof e&&e.length>0?[e]:[]}(s),n=[];return 0===p.length?n.push({key:`duplicate-${e}`,postId:t,targetPostType:null,currentPostType:e,targetPostTypeObject:s}):p.forEach(o=>{const p=r.find(t=>t.slug===o);o===e?n.push({key:`duplicate-${e}`,postId:t,targetPostType:null,currentPostType:e,targetPostTypeObject:s}):n.push({key:`transform-${e}-to-${o}`,postId:t,targetPostType:o,currentPostType:e,targetPostTypeObject:p})}),(0,u.jsx)(o.PluginPostStatusInfo,{className:"post-morph-status-info",children:n.map(({key:t,...e})=>(0,u.jsx)(l,{...e},t))})}})})();